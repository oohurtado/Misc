<app-breadcrumb [data]="breadcrumb"></app-breadcrumb>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                Scrap data
                <br>
                <span class="text-secondary">URL: https://www.espn.com/f1/standings</span>
            </div>
            <div class="card-body">
                @if (myForm) {
                    <form [formGroup]="myForm" (ngSubmit)="onDoneClicked()" autocomplete="off">
                        <div class="row">
                            <div class="col-md-12 mt-2">
                                <div class="form-floating">
                                    <select class="form-select" formControlName="type" id="type" aria-label="Floating label select example">
                                        <option [ngValue]="null" disabled selected>Select an option</option>
                                        @for(item of types; track item) {
                                            <option [value]="item">{{ item }}</option>
                                        }
                                    </select>
                                    <label for="floatingSelect">Type</label>
                                </div>
                                @if (hasError('type', 'required')) {
                                    <span class="text-danger d-block">This field is required</span>
                                }
                            </div>
                            <div class="col-md-12 mt-2">
                                <div class="form-floating">
                                    <select class="form-select" formControlName="year" id="year" aria-label="Floating label select example">
                                        <option [ngValue]="null" disabled selected>Select an option</option>
                                        @for(item of years; track item) {
                                            <option [value]="item">{{ item }}</option>
                                        }
                                    </select>
                                    <label for="floatingSelect">Year</label>
                                </div>
                                @if (hasError('year', 'required')) {
                                    <span class="text-danger d-block">This field is required</span>
                                }
                            </div>
                            <div class="col-md-12 mt-2 mb-2">
                                <button type="submit" class="btn btn-primary" [disabled]="isProcesing">
                                    @if(isProcesing) {
                                        <span><i class="fas fa-sync fa-spin"></i>&nbsp;&nbsp;Scraping</span>
                                    } @else {
                                        <span><i class="fa-solid fa-cloud"></i>&nbsp;&nbsp;Scrap</span>
                                    }
                                </button>
                            </div>                                 
                        </div>
                    </form>
                }
                @if(errorMessage != null)
                {
                    <div  class="alert alert-danger ml-4 mr-4" role="alert">
                        {{ errorMessage }}
                    </div>                
                }                
            </div>
        </div>
    </div>
    <div class="col-md-6">

        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th [width]="'1%'">Origin</th>
                        <th [width]="'1%'">Time</th>
                        <th [width]="'100%'">Message</th>
                    </tr>
                </thead>
                <tbody>
                    @if(messages.length == 0) {
                       <tr>
                            <td colspan="3">No messages available</td>
                       </tr> 
                    } @else {
                        @for(item of messages; track $index) {
                            <tr>
                                <td style="white-space:nowrap;">{{ item.param1 }}</td>
                                <td style="white-space:nowrap;">{{ item.param3 | date:'hh:mm:ss a'}}</td>
                                <td style="white-space:nowrap;">{{ item.param2 }}</td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>